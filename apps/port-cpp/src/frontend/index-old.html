<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>File Viewer</title>
	<link rel="stylesheet" href="/styles.css">
</head>
<body>
	<div class="connection-status">
		<div class="status-circle" id="status-circle"></div>
		<span id="connection-status">Connecting...</span>
	</div>
	
	
	<div class="container">
		<div class="left-section">
			<div class="panel">
				<div class="content">
					<div class="empty-state">
						<div class="empty-message">No files opened</div>
					</div>
				</div>
			</div>
		</div>
		
		<div class="resizer" id="resizer"></div>
		
		<div class="right-section">
			<!-- Panel 1 content will be dynamically generated -->
		</div>
	</div>

	<!-- Monaco Editor -->
	<script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.44.0/min/vs/loader.js"></script>
	
	<!-- Load new architecture components in dependency order -->
	<script src="/FileIdentity.js"></script>
	<script src="/FileModel.js"></script>
	<script src="/WebSocketManager.js"></script>
	<script src="/Panel.js"></script>
	<script src="/FileView.js"></script>
	<script src="/app.js"></script>
	
	<!-- Initialize the application -->
	<script>
		// Capture console logs for debugging
		window.capturedLogs = [];
		const originalConsoleLog = console.log;
		const originalConsoleError = console.error;
		
		console.log = function(...args) {
			window.capturedLogs.push({ type: 'log', args: args, timestamp: Date.now() });
			originalConsoleLog.apply(console, args);
		};
		
		console.error = function(...args) {
			window.capturedLogs.push({ type: 'error', args: args, timestamp: Date.now() });
			originalConsoleError.apply(console, args);
		};
		
		// Initialize the new file viewer app
		let app;
		
		// Wait for DOM to be ready
		document.addEventListener('DOMContentLoaded', () => {
			console.log('ðŸš€ Starting new File Viewer architecture');
			try {
				app = new App();
				window.app = app; // Make app accessible for debugging
				
			} catch (error) {
				console.error('Failed to initialize app:', error);
			}
		});
		
		// Cleanup on page unload
		window.addEventListener('beforeunload', () => {
			if (app) {
				app.dispose();
			}
		});
	</script>
</body>
</html>